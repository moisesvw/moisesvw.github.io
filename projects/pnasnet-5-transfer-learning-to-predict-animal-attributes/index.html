<!DOCTYPE html>
<html lang="en-us">
  <head>
    
    <script type="application/ld+json">

{  
  "@context":"http://schema.org",
  "@type":"Website",
  "@id":"https:\/\/moisesvw.github.io\/",
  "author": {
    "@type": "Person",
    "name": "Moisés Vargas",
    
  },
  "name":"Machine Learning Stuffs",
  "description":"This project aims to build a predictive model that learn to identify attributes associated with each animal. It was part of hackerearth.com Challenge. It provides 18.000 images of 50 different categories, 12.600 have animal characteristics. These characteristics are treated as labels to train a predictive model that learns to map animal images to attributes. This set of 12600 images will be the training set.\nMetrics There are 85 different attributes per image in the training set.",
  "url":"https:\/\/moisesvw.github.io\/projects\/pnasnet-5-transfer-learning-to-predict-animal-attributes\/",
  "keywords":"[, machine-learning, self-driving-cars]"
}

</script>
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="generator" content="Hugo 0.110.0 with theme Tranquilpeak 0.5.3-BETA">
<meta name="author" content="Moisés Vargas">
<meta name="keywords" content=", machine-learning, self-driving-cars">
<meta name="description" content="This project aims to build a predictive model that learn to identify attributes associated with each animal. It was part of hackerearth.com Challenge. It provides 18.000 images of 50 different categories, 12.600 have animal characteristics. These characteristics are treated as labels to train a predictive model that learns to map animal images to attributes. This set of 12600 images will be the training set.
Metrics There are 85 different attributes per image in the training set.">


<meta property="og:description" content="This project aims to build a predictive model that learn to identify attributes associated with each animal. It was part of hackerearth.com Challenge. It provides 18.000 images of 50 different categories, 12.600 have animal characteristics. These characteristics are treated as labels to train a predictive model that learns to map animal images to attributes. This set of 12600 images will be the training set.
Metrics There are 85 different attributes per image in the training set.">
<meta property="og:type" content="article">
<meta property="og:title" content="PNASNet-5 Transfer Learning to Predict Animal Attributes">
<meta name="twitter:title" content="PNASNet-5 Transfer Learning to Predict Animal Attributes">
<meta property="og:url" content="https://moisesvw.github.io/projects/pnasnet-5-transfer-learning-to-predict-animal-attributes/">
<meta property="twitter:url" content="https://moisesvw.github.io/projects/pnasnet-5-transfer-learning-to-predict-animal-attributes/">
<meta property="og:site_name" content="Machine Learning Stuffs">
<meta property="og:description" content="This project aims to build a predictive model that learn to identify attributes associated with each animal. It was part of hackerearth.com Challenge. It provides 18.000 images of 50 different categories, 12.600 have animal characteristics. These characteristics are treated as labels to train a predictive model that learns to map animal images to attributes. This set of 12600 images will be the training set.
Metrics There are 85 different attributes per image in the training set.">
<meta name="twitter:description" content="This project aims to build a predictive model that learn to identify attributes associated with each animal. It was part of hackerearth.com Challenge. It provides 18.000 images of 50 different categories, 12.600 have animal characteristics. These characteristics are treated as labels to train a predictive model that learns to map animal images to attributes. This set of 12600 images will be the training set.
Metrics There are 85 different attributes per image in the training set.">
<meta property="og:locale" content="en-us">

  
    <meta property="article:published_time" content="2018-06-14T00:00:00">
  
  
    <meta property="article:modified_time" content="2018-06-14T00:00:00">
  
  
  
  


<meta name="twitter:card" content="summary">

  <meta name="twitter:site" content="@moisesvw">


  <meta name="twitter:creator" content="@moisesvw">











    <title>PNASNet-5 Transfer Learning to Predict Animal Attributes</title>

    <link rel="icon" href="https://moisesvw.github.io/robot-network-icon.png">
    

    

    <link rel="canonical" href="https://moisesvw.github.io/projects/pnasnet-5-transfer-learning-to-predict-animal-attributes/">

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" integrity="sha512-iBBXm8fW90+nuLcSKlbmrPcLa0OT92xO1BIsZ+ywDWZCvqsWgccV3gFoRBv0z+8dLJgyAHIhR35VZc2oM/gI1w==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha512-H9jrZiiopUdsLpg94A333EfumgUBpO9MdbxStdeITo+KEIMaNfHNvwyjjDJb+ERPaRS6DpyRlKbvPUasNItRyw==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    
    
    
    <link rel="stylesheet" href="https://moisesvw.github.io/css/style-h6ccsoet3mzkbb0wngshlfbaweimexgqcxj0h5hu4h82olsdzz6wmqdkajm.min.css" />
    
    

    
      
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-92619527-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
    
    
  </head>

  <body>
    <div id="blog">
      <header id="header" data-behavior="2">
  <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
  <div class="header-title">
    <a class="header-title-link" href="/" aria-label="Go to homepage">Machine Learning Stuffs</a>
  </div>
  
    
      <a class="header-right-picture "
         href="/#about" aria-label="Open the link: /#about">
    
    
    
      
    
    </a>
  
</header>

      <nav id="sidebar" data-behavior="2">
  <div class="sidebar-container">
    
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="/archives" title="Archives">
    
      <i class="sidebar-button-icon fa fa-lg fa-archive"></i>
      
      <span class="sidebar-button-desc">Archives</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://github.com/moisesvw" target="_blank" rel="noopener" title="GitHub">
    
      <i class="sidebar-button-icon fa fa-lg fa-github"></i>
      
      <span class="sidebar-button-desc">GitHub</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.linkedin.com/in/moisesvw/" target="_blank" rel="noopener" title="LinkedIn">
    
      <i class="sidebar-button-icon fa fa-lg fa-linkedin"></i>
      
      <span class="sidebar-button-desc">LinkedIn</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://twitter.com/moisesvw" target="_blank" rel="noopener" title="Twitter">
    
      <i class="sidebar-button-icon fa fa-lg fa-twitter"></i>
      
      <span class="sidebar-button-desc">Twitter</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      

    </ul>
  </div>
</nav>

      

      <div id="main" data-behavior="2"
        class="
               hasCoverMetaIn
               ">
        <article class="post" id="top">
          
          
            <div class="post-header main-content-wrap text-left">
  
    <h1 class="post-title">
      PNASNet-5 Transfer Learning to Predict Animal Attributes
    </h1>
  
  
  <div class="postShorten-meta post-meta">
    
      <time datetime="2018-06-14T00:00:00Z">
        
  June 14, 2018

      </time>
    
    
  </div>

</div>
          
          <div class="post-content markdown">
            <div class="main-content-wrap">
              <p>This project aims to build a predictive model that learn to identify attributes associated with each animal. It was part of <a href="https://www.hackerearth.com/">hackerearth.com Challenge</a>. It provides 18.000 images of 50 different categories, 12.600 have animal characteristics. These characteristics are treated as labels to train a predictive model that learns to map animal images to attributes. This set of 12600 images will be the training set.</p>
<p><img src="https://cdn-images-1.medium.com/max/2000/1*y1Jb1J12hNyocD7IdXz14g.png" alt="alt text"></p>
<h2 id="metrics">Metrics</h2>
<p>There are 85 different attributes per image in the training set. Two metrics monitor the model performance. A vector of 85 positions such that each location contains either 0 or 1 represents image characteristics. Each position corresponds to a single attribute; For instance, the first eight positions are color attributes such that position with index 0 is black and position with index 7 is yellow. The position with index 84, which is last is domestic.</p>
<h5 id="accuracy">Accuracy</h5>
<p>The number of correct predicted attributes cross all examples divided by a total number of characteristics of all examples.</p>
<!-- raw HTML omitted -->
<h5 id="loss-cross-entropy">Loss Cross-Entropy</h5>
<p>The cost function besides that convey information to the model on how well it is doing to adjust parameters, also indicates the confidence of the results.</p>
<p>$$-\frac{1}{m} \sum_{i=1}^m \Big[ y_{i} \cdot \log(\hat{y})+(1-y_{i})\cdot \log(1-\hat{y}) \Big]$$</p>
<h2 id="features-and-training">Features and Training</h2>
<p>The extraction of features took roughly 5 hours; using TensorFlowHub I’ve extracted features (bottlenecks) from both train and test images, with the Progressive Neural Architecture Search (PNASNet-5) architecture. After passing all pictures over this network, the result was having a vector containing 4320 features per image.</p>
<pre tabindex="0"><code>python retrain.py \
— image_dir ./DL3Dataset \
— tfhub_module https://tfhub.dev/google/imagenet/pnasnet_large/feature_vector/1
</code></pre><p>The features are feed into a two-layer network model from Keras; details are <a href="https://github.com/moisesvw/dojo/blob/master/challenge/attributes-of-animals/bottles.ipynb">here</a>. And using 30 epochs; where each epoch runs in less than 5 seconds, I was able to have a model with 98.3% of accuracy. The accuracy keeps in both train and validation sets. The image below shows how this happens and how the metrics perform during training.</p>
<p><img src="https://cdn-images-1.medium.com/max/1600/1*8w_C-MvJhh-6PcLD8yCzBw.gif" alt="alt text"></p>
<h2 id="results">Results</h2>
<p>The model reports excellent performance on train and validation sets up to 98.4% of accuracy and 0.03 of cost on the loss function.
Some images from the validation set are sampled and show the predicted attributes and the actual attributes below:</p>
<p><img src="https://cdn-images-1.medium.com/max/1600/1*zCKtqa5ZfYnJ2o83JaqS8A.gif" alt="alt text"></p>
<p>Two pictures are randomly selected from the test set which are unseen examples given by HackerEarth challenge, uploading the output predictions from the entire test set HackerEarth performance measurement gives 98.4% of accuracy on the test set.</p>
<p>Here there are two random images from the test set and its predicted attributes.</p>
<p><img src="/images/animal_attributes/pred1.png" alt="alt test"></p>
<p><img src="/images/animal_attributes/pred3.png" alt="alt test"></p>
<h2 id="conclusion">Conclusion</h2>
<p>The final model gets excellent results; it does not show any sign of overfitting or bias out of the normal. This model even can be improved by analyzing further how the images were tagged with attributes and explore if all attributes are well tagged to each image.</p>
<p>All of the details an code are in this <a href="https://github.com/moisesvw/dojo/tree/master/challenge/attributes-of-animals">GitHub repository.</a></p>
<p><a href="https://medium.com/@moisesvargas/predict-the-attributes-of-the-animal-using-deep-learning-5bd6cbe01fa5">Medium Post</a></p>

              


            </div>
          </div>
          <div id="post-footer" class="post-footer main-content-wrap">
            
              
            
            <div class="post-actions-wrap">
  <nav>
    <ul class="post-actions post-action-nav">
      
        <li class="post-action">
          
            <a class="post-action-btn btn btn--disabled">
          
            <i class="fa fa-angle-left"></i>
            <span class="hide-xs hide-sm text-small icon-ml">NEXT</span>
          </a>
        </li>
        <li class="post-action">
          
            <a class="post-action-btn btn btn--default tooltip--top" href="/projects/self-driving-cars-10-projects/" data-tooltip="Self Driving Cars (10) Projects ">
          
            <span class="hide-xs hide-sm text-small icon-mr">PREVIOUS</span>
            <i class="fa fa-angle-right"></i>
          </a>
        </li>
      
    </ul>
  </nav>
  <ul class="post-actions post-action-share">
    
      <li class="post-action hide-lg hide-md hide-sm">
        <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions">
          <i class="fa fa-share-alt"></i>
        </a>
      </li>
      <li class="post-action hide-xs">
        <a class="post-action-btn btn btn--default" target="new" href="https://plus.google.com/share?url=https%3a%2f%2fmoisesvw.github.io%2fprojects%2fpnasnet-5-transfer-learning-to-predict-animal-attributes%2f">
          <i class="fa fa-google-plus"></i>
        </a>
      </li>
      <li class="post-action hide-xs">
        <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fmoisesvw.github.io%2fprojects%2fpnasnet-5-transfer-learning-to-predict-animal-attributes%2f">
          <i class="fa fa-facebook-official"></i>
        </a>
      </li>
      <li class="post-action hide-xs">
        <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=https%3a%2f%2fmoisesvw.github.io%2fprojects%2fpnasnet-5-transfer-learning-to-predict-animal-attributes%2f">
          <i class="fa fa-twitter"></i>
        </a>
      </li>
    
  </ul>
</div>


            
  


          </div>
        </article>
        <footer id="footer" class="main-content-wrap">
  <span class="copyrights">
    &copy; 2023 Moises Vargas. All Rights Reserved
  </span>
</footer>

      </div>
      <div id="bottom-bar" class="post-bottom-bar" data-behavior="2">
        <div class="post-actions-wrap">
  <nav>
    <ul class="post-actions post-action-nav">
      
        <li class="post-action">
          
            <a class="post-action-btn btn btn--disabled">
          
            <i class="fa fa-angle-left"></i>
            <span class="hide-xs hide-sm text-small icon-ml">NEXT</span>
          </a>
        </li>
        <li class="post-action">
          
            <a class="post-action-btn btn btn--default tooltip--top" href="/projects/self-driving-cars-10-projects/" data-tooltip="Self Driving Cars (10) Projects ">
          
            <span class="hide-xs hide-sm text-small icon-mr">PREVIOUS</span>
            <i class="fa fa-angle-right"></i>
          </a>
        </li>
      
    </ul>
  </nav>
  <ul class="post-actions post-action-share">
    
      <li class="post-action hide-lg hide-md hide-sm">
        <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions">
          <i class="fa fa-share-alt"></i>
        </a>
      </li>
      <li class="post-action hide-xs">
        <a class="post-action-btn btn btn--default" target="new" href="https://plus.google.com/share?url=https%3a%2f%2fmoisesvw.github.io%2fprojects%2fpnasnet-5-transfer-learning-to-predict-animal-attributes%2f">
          <i class="fa fa-google-plus"></i>
        </a>
      </li>
      <li class="post-action hide-xs">
        <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fmoisesvw.github.io%2fprojects%2fpnasnet-5-transfer-learning-to-predict-animal-attributes%2f">
          <i class="fa fa-facebook-official"></i>
        </a>
      </li>
      <li class="post-action hide-xs">
        <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=https%3a%2f%2fmoisesvw.github.io%2fprojects%2fpnasnet-5-transfer-learning-to-predict-animal-attributes%2f">
          <i class="fa fa-twitter"></i>
        </a>
      </li>
    
  </ul>
</div>


      </div>
      

    </div>
    
    <div id="about">
  <div id="about-card">
    <div id="about-btn-close">
      <i class="fa fa-times"></i>
    </div>
    
    <h4 id="about-card-name">Moisés Vargas</h4>
    
      <div id="about-card-bio">Life Long Learner</div>
    
    
      <div id="about-card-job">
        <i class="fa fa-briefcase"></i>
        <br/>
        Machine Learning Engineer
      </div>
    
    
      <div id="about-card-location">
        <i class="fa fa-map-marker-alt"></i>
        <br/>
        Medellín
      </div>
    
  </div>
</div>

    

    
  
    
      
      <div id="cover" style="background-image:url('https://moisesvw.github.io/images/sfbridge_.jpg');"></div>
    
  


    
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" integrity="sha512-894YE6QWD5I59HgZOGReFYm4dnWc1Qt5NtvYSaNcOP+u1T9qYdvdihz0PPSiiqn/+/3e7Jo4EaG7TubfWGUrMQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha512-uURl+ZXMBrF4AwGaWmEetzrd+J5/8NRkWAvJx5sbPSSuOb0bZLqf+tOzniObO00BjHa/dD7gub9oCGMLPQHtQA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>


<script src="https://moisesvw.github.io/js/script-yqzy9wdlzix4lbbwdnzvwx3egsne77earqmn73v9uno8aupuph8wfguccut.min.js"></script>






    
  </body>
</html>

