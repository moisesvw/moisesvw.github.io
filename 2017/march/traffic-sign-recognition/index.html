<!DOCTYPE html>
<html lang="en-us">
  <head>
    
    <script type="application/ld+json">

{  
  "@context":"http://schema.org",
  "@type":"Website",
  "@id":"https:\/\/moisesvw.github.io\/",
  "author": {
    "@type": "Person",
    "name": "Moisés Vargas",
    
  },
  "name":"Machine Learning Stuffs",
  "description":"Build a Traffic Sign Recognition Project The goals\/steps of this project are the following:\nLoad the data set (see below for links to the project data set) Explore, summarize and visualize the data set Design, train and test a model architecture Use the model to make predictions on new images Analyze the softmax probabilities of the unseen photos Summarize the results with a written report Data Set Summary \u0026amp; Exploration 1.",
  "url":"https:\/\/moisesvw.github.io\/2017\/march\/traffic-sign-recognition\/",
  "keywords":"[, machine-learning, self-driving-cars]"
}

</script>
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="generator" content="Hugo 0.110.0 with theme Tranquilpeak 0.5.3-BETA">
<meta name="author" content="Moisés Vargas">
<meta name="keywords" content=", machine-learning, self-driving-cars">
<meta name="description" content="Build a Traffic Sign Recognition Project The goals/steps of this project are the following:
Load the data set (see below for links to the project data set) Explore, summarize and visualize the data set Design, train and test a model architecture Use the model to make predictions on new images Analyze the softmax probabilities of the unseen photos Summarize the results with a written report Data Set Summary &amp; Exploration 1.">


<meta property="og:description" content="Build a Traffic Sign Recognition Project The goals/steps of this project are the following:
Load the data set (see below for links to the project data set) Explore, summarize and visualize the data set Design, train and test a model architecture Use the model to make predictions on new images Analyze the softmax probabilities of the unseen photos Summarize the results with a written report Data Set Summary &amp; Exploration 1.">
<meta property="og:type" content="article">
<meta property="og:title" content="Traffic Sign Recognition">
<meta name="twitter:title" content="Traffic Sign Recognition">
<meta property="og:url" content="https://moisesvw.github.io/2017/march/traffic-sign-recognition/">
<meta property="twitter:url" content="https://moisesvw.github.io/2017/march/traffic-sign-recognition/">
<meta property="og:site_name" content="Machine Learning Stuffs">
<meta property="og:description" content="Build a Traffic Sign Recognition Project The goals/steps of this project are the following:
Load the data set (see below for links to the project data set) Explore, summarize and visualize the data set Design, train and test a model architecture Use the model to make predictions on new images Analyze the softmax probabilities of the unseen photos Summarize the results with a written report Data Set Summary &amp; Exploration 1.">
<meta name="twitter:description" content="Build a Traffic Sign Recognition Project The goals/steps of this project are the following:
Load the data set (see below for links to the project data set) Explore, summarize and visualize the data set Design, train and test a model architecture Use the model to make predictions on new images Analyze the softmax probabilities of the unseen photos Summarize the results with a written report Data Set Summary &amp; Exploration 1.">
<meta property="og:locale" content="en-us">

  
    <meta property="article:published_time" content="2017-03-27T00:00:00">
  
  
    <meta property="article:modified_time" content="2017-03-27T00:00:00">
  
  
  
  


<meta name="twitter:card" content="summary">

  <meta name="twitter:site" content="@moisesvw">


  <meta name="twitter:creator" content="@moisesvw">











    <title>Traffic Sign Recognition</title>

    <link rel="icon" href="https://moisesvw.github.io/robot-network-icon.png">
    

    

    <link rel="canonical" href="https://moisesvw.github.io/2017/march/traffic-sign-recognition/">

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" integrity="sha512-iBBXm8fW90+nuLcSKlbmrPcLa0OT92xO1BIsZ+ywDWZCvqsWgccV3gFoRBv0z+8dLJgyAHIhR35VZc2oM/gI1w==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha512-H9jrZiiopUdsLpg94A333EfumgUBpO9MdbxStdeITo+KEIMaNfHNvwyjjDJb+ERPaRS6DpyRlKbvPUasNItRyw==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    
    
    
    <link rel="stylesheet" href="https://moisesvw.github.io/css/style-h6ccsoet3mzkbb0wngshlfbaweimexgqcxj0h5hu4h82olsdzz6wmqdkajm.min.css" />
    
    

    
      
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-92619527-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
    
    
  </head>

  <body>
    <div id="blog">
      <header id="header" data-behavior="2">
  <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
  <div class="header-title">
    <a class="header-title-link" href="/" aria-label="Go to homepage">Machine Learning Stuffs</a>
  </div>
  
    
      <a class="header-right-picture "
         href="/#about" aria-label="Open the link: /#about">
    
    
    
      
    
    </a>
  
</header>

      <nav id="sidebar" data-behavior="2">
  <div class="sidebar-container">
    
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="/archives" title="Archives">
    
      <i class="sidebar-button-icon fa fa-lg fa-archive"></i>
      
      <span class="sidebar-button-desc">Archives</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://github.com/moisesvw" target="_blank" rel="noopener" title="GitHub">
    
      <i class="sidebar-button-icon fa fa-lg fa-github"></i>
      
      <span class="sidebar-button-desc">GitHub</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.linkedin.com/in/moisesvw/" target="_blank" rel="noopener" title="LinkedIn">
    
      <i class="sidebar-button-icon fa fa-lg fa-linkedin"></i>
      
      <span class="sidebar-button-desc">LinkedIn</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://twitter.com/moisesvw" target="_blank" rel="noopener" title="Twitter">
    
      <i class="sidebar-button-icon fa fa-lg fa-twitter"></i>
      
      <span class="sidebar-button-desc">Twitter</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      

    </ul>
  </div>
</nav>

      

      <div id="main" data-behavior="2"
        class="
               hasCoverMetaIn
               ">
        <article class="post" id="top">
          
          
            <div class="post-header main-content-wrap text-left">
  
    <h1 class="post-title">
      Traffic Sign Recognition
    </h1>
  
  
  <div class="postShorten-meta post-meta">
    
      <time datetime="2017-03-27T00:00:00-05:00">
        
  March 27, 2017

      </time>
    
    
  </div>

</div>
          
          <div class="post-content markdown">
            <div class="main-content-wrap">
              <h1 id="build-a-traffic-sign-recognition-project"><strong>Build a Traffic Sign Recognition Project</strong></h1>
<p>The goals/steps of this project are the following:</p>
<ul>
<li>Load the data set (see below for links to the project data set)</li>
<li>Explore, summarize and visualize the data set</li>
<li>Design, train and test a model architecture</li>
<li>Use the model to make predictions on new images</li>
<li>Analyze the softmax probabilities of the unseen photos</li>
<li>Summarize the results with a written report</li>
</ul>
<h3 id="data-set-summary--exploration">Data Set Summary &amp; Exploration</h3>
<h4 id="1-data-exploration">1. Data Exploration</h4>
<p>The code for this step is contained in the second code cell of the IPython notebook.</p>
<p>I used numpy shape attribute and the pandas library to calculate summary statistics of the traffic
signs data set:</p>
<ul>
<li>The size of training set is 34799</li>
<li>The size of test set is 12630</li>
<li>The shape of a traffic sign image is 32x32x3</li>
<li>The number of unique classes/labels in the data set is 43</li>
</ul>
<h4 id="2-include-an-exploratory-visualization-of-the-dataset-and-identify-where-the-code-is-in-your-code-file">2. Include an exploratory visualization of the dataset and identify where the code is in your code file.</h4>
<p>The code for this step is contained in the third code cell of the IPython notebook.</p>
<p>Here is an exploratory visualization of the data set. It is a bar chart showing the numbers
of occurrences of each label in the data set.</p>
<p>Here I can see basic summary for the labels above:</p>
<ul>
<li>Label 2 - (&ldquo;Speed limit (50km/h)&rdquo;) it is the label with more example about 2000 examples
<ul>
<li><img src="/carnd/p2/examples/2_speed_limit.png" alt="alt text" title="Speed limit (50km/h)"></li>
</ul>
</li>
<li>Labels with less examples roughly between 190 - 200:
<ul>
<li>0 - (&ldquo;Speed limit (20km/h)&rdquo;) are
<ul>
<li><img src="/carnd/p2/examples/0_speed_limit.png" alt="alt text" title="Speed limit (20km/h)"></li>
</ul>
</li>
<li>19 - (&ldquo;Dangerous curve to the left&rdquo;)
<ul>
<li><img src="/carnd/p2/examples/19_dangerous_curve.png" alt="alt text" title="Dangerous curve to the left"></li>
</ul>
</li>
<li>32 - (&ldquo;End of all speed and passing limits&rdquo;)
<ul>
<li><img src="/carnd/p2/examples/32_passing_limits.png" alt="alt text" title="End of all speed and passing limits"></li>
</ul>
</li>
</ul>
</li>
</ul>
<p>I&rsquo;ll perform some experiments in training and keep in mind that maybe data augmentation will be
necessary to refining the final model.</p>
<p><img src="/carnd/p2/examples/labels_exploration.png" alt="alt text" title="Visualization"></p>
<h3 id="design-and-test-a-model-architecture">Design and Test a Model Architecture</h3>
<h4 id="1-preprocessing-data">1. Preprocessing Data</h4>
<p>Before starting any design or changes, I wanted to consider baseline results using the <a href="http://yann.lecun.com/exdb/lenet/index.html">LetNet-5 Convolutional Neural Network</a>. In the baseline step, I feed the LetNet5 with the training set and measure performance on both training and testing sets. The data feed in this step has not any pre-processing changes.</p>
<p>The results below shows a Baseline - Validation Accuracy = 0.878 and Baseline Test Accuracy = 0.867. With this base results, the next step is to improve them by pre-processing data and to perform design change in LetNet-5 Architecture.</p>
<pre tabindex="0"><code>*Baseline - EPOCH 1 ...
*Baseline - Validation Accuracy = 0.639
*Baseline - EPOCH 2 ...
*Baseline - Validation Accuracy = 0.755
*Baseline - EPOCH 3 ...
*Baseline - Validation Accuracy = 0.807
*Baseline - EPOCH 4 ...
*Baseline - Validation Accuracy = 0.845
*Baseline - EPOCH 5 ...
*Baseline - Validation Accuracy = 0.829
*Baseline - EPOCH 6 ...
*Baseline - Validation Accuracy = 0.837
*Baseline - EPOCH 7 ...
*Baseline - Validation Accuracy = 0.852
*Baseline - EPOCH 8 ...
*Baseline - Validation Accuracy = 0.866
*Baseline - EPOCH 9 ...
*Baseline - Validation Accuracy = 0.861
*Baseline - EPOCH 10 ...
*Baseline - Validation Accuracy = 0.878
Baseline Test Accuracy = 0.867
</code></pre><p>Preprocessed Data</p>
<p>The code for this step is contained in the ninth code cell of the IPython notebook.</p>
<ul>
<li>
<p>Normalization</p>
<p>I normalized the image data by subtracting 128 pixels from the image and then divided by 128, and it will make data be centered around zero, which it is desirable for the optimizer.</p>
<p><img src="/carnd/p2/examples/9_no_passing_normalized.png" alt="alt text" title="Normalized example">
<img src="/carnd/p2/examples/9_no_passing.png" alt="alt text" title="raw example"></p>
</li>
</ul>
<h4 id="2-data">2. Data</h4>
<p>The data is split into training, validation, and test sets, the sklearn function shuffle is used to randomize the training data in the fifteenth code cell of the IPython notebook.</p>
<p>My final training set had 90300 number of images. My validation set and test set had 4410 and 12630 number of images.</p>
<p>The eleventh code cell of the IPython notebook contains the code for augmenting the data set.</p>
<ul>
<li>
<p>Data Augmentation
The training dataset was augmented with the following steps</p>
<ol>
<li>Per class randomly select an image from that class</li>
<li>Apply randomly one of these transformations (clipped_zoom, bright_trasform, rotate_) with random parameters</li>
<li>Append the new augmented image to a list</li>
<li>repeat steps 1 to 3 until the number of elements of the list plus number of example of current class sums 2100</li>
<li>append the augmented list to the current training data</li>
</ol>
<ul>
<li>
<p>Here is an example of an original image and an augmented Images:</p>
</li>
<li>
<p>original image</p>
</li>
</ul>
<p><img src="/carnd/p2/examples/9_no_passing.png" alt="alt text" title="raw example"></p>
<ul>
<li>bright_trasform(8.66), clipped_zoom(0.58), rotate_(15.5)</li>
</ul>
<p><img src="/carnd/p2/examples/9_no_passing_bright.png" alt="alt text" title="augmentation example"> <img src="/carnd/p2/examples/9_no_passing_zoom.png" alt="alt text" title="augmentation example">  <img src="/carnd/p2/examples/9_no_passing_rotate.png" alt="alt text" title="augmentation example"></p>
<p>The data augmentation only it is performed as a step in the final model to gain more accuracy.</p>
<p>The difference between the original data set and the augmented data set is the following:</p>
<ul>
<li>All classes have the same number of examples 2100 per class</li>
<li>The expanded dataset has 90300 images in total</li>
</ul>
</li>
</ul>
<h4 id="3-model-architecture">3. Model Architecture</h4>
<p>The code for my final model is located in the fourteenth cell of the Jupyter notebook.</p>
<p>My final model consisted of the following layers:</p>
<table>
<thead>
<tr>
<th style="text-align:center">Layer</th>
<th style="text-align:left">Description</th>
<th style="text-align:right"></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">Input</td>
<td style="text-align:left">32x32x3 RGB image</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:center">Convolution 5x5x3x20</td>
<td style="text-align:left">1x1 stride, &lsquo;VALID&rsquo; padding, outputs 28x28x20</td>
<td></td>
</tr>
<tr>
<td style="text-align:center">RELU</td>
<td style="text-align:left"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:center">Max pooling</td>
<td style="text-align:left">2x2 stride,  outputs 14x114x20</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:center">Convolution 5x5x20x50</td>
<td style="text-align:left">1x1 stride, &lsquo;VALID&rsquo; padding, outputs 10x10x50</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:center">RELU</td>
<td style="text-align:left"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:center">Max pooling</td>
<td style="text-align:left">2x2 stride,  outputs 5x5x50</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:center">Fully connected  input 1250</td>
<td style="text-align:left">outputs 140</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:center">RELU</td>
<td style="text-align:left"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:center">DROPOUT</td>
<td style="text-align:left">0.50</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:center">Fully connected  input 140</td>
<td style="text-align:left">outputs 100</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:center">RELU</td>
<td style="text-align:left"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:center">DROPOUT</td>
<td style="text-align:left">0.50</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:center">Fully connected  input 100</td>
<td style="text-align:left">outputs 43</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:center">Softmax</td>
<td style="text-align:left"></td>
<td style="text-align:right"></td>
</tr>
</tbody>
</table>
<h4 id="4-training">4. Training</h4>
<p>The code for training the model is located in the fifteenth and sixteenth cells of the Jupyter notebook.</p>
<p>To train the model, I used an AdamOptimizer with a learning rate of 0.001, EPOCHS 15, and BATCH_SIZE 128.
Two dropouts were set up to 0.75.</p>
<p>The model was trained inside a tensor flow session in which iterate over the EPOCHS, in each EPOCH pass training data was randomize with <code>sklearn#shuffle</code> function, the training operation was performed multiple times according to number of BATCHES in the training set and an accuracy measure was performed on both validation set and the last batch of the training set.</p>
<p>To run the training operation; the feed dictionary contains the batches for examples, labels, and the probability used for the dropout layer.</p>
<h4 id="5-experiments">5. Experiments</h4>
<p>The code for calculating the accuracy of the model is located in the sixteenth cell of the Ipython notebook.</p>
<ul>
<li>
<p>What was the first architecture that was tried and why was it chosen?</p>
</li>
<li>
<p>What were some problems with the initial architecture?</p>
</li>
<li>
<p>How was the architecture adjusted, and why was it changed? Typical adjustments could include selecting a different model architecture, adding or taking away layers (pooling, dropout, convolution, etc.), using an activation function or changing the activation function. One common justification for adjusting an architecture would be due to overfitting or underfitting. High accuracy on the training set but low accuracy on the validation set indicates overfitting; a low accuracy on both sets indicates underfitting.</p>
</li>
<li>
<p>Which parameters were tuned? How were they adjusted and why?</p>
</li>
<li>
<p>What are some of the essential design choices and why were they chosen? For example, why might a convolution layer work well with this problem? How might a dropout layer help with creating a successful model?</p>
</li>
<li>
<p>What architecture was chosen?</p>
</li>
<li>
<p>Why did you believe it would be relevant to the traffic sign application?</p>
</li>
<li>
<p>How does the final model&rsquo;s accuracy on the training, validation and test sets provide evidence that the model is working well?</p>
</li>
</ul>
<p>I&rsquo;ll try to address the questions above in next lines;</p>
<p>LeNet-5 was the architecture used in this project, it is a well known neural network, it appear roughly in 1998, and it is well suited to recognize visual patterns directly from pixels. <a href="http://yann.lecun.com/exdb/lenet/index.html">LetNet-5</a></p>
<p>To achieve the results above, the first model was trained with original LeNet-5 architecture, not getting good results since both validation and test accuracies were poor, the next step was increasing the number of EPOCHS that did not help at all the validation accuracy did not overcome 0.868 and the test accuracy was 0.858 after 50 EPOCHS.</p>
<p>At that point, data was not normalized; the next parameter to tune was learning rate by increasing it to 0.01 both validation, and test accuracies were down to less than 0.058. Decreasing learning rate to 0.0001 with 50 epochs ends in the same result that increasing epochs for the first time. At this point, a possible conclusion is that LeNet-5 can not learn with data which is not normalized.</p>
<p>The next step was normalizing data and repeat training with original LetNet-5, learning rate 0.001 and 50 epochs, this time model get a Validation Accuracy = 0.945 and Test Accuracy = 0.934.</p>
<p>Next step was trying to add more complexity to the net by increasing filter from 6 to 20 and from 16 to 50 respectively for the two convolution layers; under the assumption that increasing filter would give to the network ability to differentiate more between 43 labels rather than ten labels. in the same sense the first two fully connected layers outputs were increase a little. Having these changes and trained with 50 epochs and rate limit of 0.001 the network training accuracy was 1.000,  validation accuracy was 0.970, and test accuracy was 0.947.</p>
<p>Under the assumption that model it is overfitting data, two dropout layers were added to the network, the table below shows the dropouts values and its results</p>
<table>
<thead>
<tr>
<th style="text-align:center">Dropout1</th>
<th style="text-align:center">Dropout2</th>
<th style="text-align:center">training accuracy</th>
<th style="text-align:center">validation accuracy</th>
<th style="text-align:center">test accuracy</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">0.75</td>
<td style="text-align:center">0.75</td>
<td style="text-align:center">1.0</td>
<td style="text-align:center">0.953</td>
<td style="text-align:center">0.931</td>
</tr>
<tr>
<td style="text-align:center">0.50</td>
<td style="text-align:center">0.75</td>
<td style="text-align:center">1.0</td>
<td style="text-align:center">0.966</td>
<td style="text-align:center">0.956</td>
</tr>
<tr>
<td style="text-align:center">0.50</td>
<td style="text-align:center">0.50</td>
<td style="text-align:center">1.0</td>
<td style="text-align:center">0.978</td>
<td style="text-align:center">0.965</td>
</tr>
<tr>
<td style="text-align:center">0.30</td>
<td style="text-align:center">0.50</td>
<td style="text-align:center">1.0</td>
<td style="text-align:center">0.972</td>
<td style="text-align:center">0.956</td>
</tr>
<tr>
<td style="text-align:center">0.50</td>
<td style="text-align:center">0.30</td>
<td style="text-align:center">1.0</td>
<td style="text-align:center">0.969</td>
<td style="text-align:center">0.966</td>
</tr>
</tbody>
</table>
<p>My final model results were:</p>
<ul>
<li>training set accuracy of 1.000</li>
<li>validation set accuracy of 0.966</li>
<li>test set accuracy of 0.965</li>
</ul>
<h3 id="final-model-parameter--data-augmentation">Final model parameter + data augmentation</h3>
<table>
<thead>
<tr>
<th style="text-align:center">Dropout-1</th>
<th style="text-align:center">Dropout-2</th>
<th style="text-align:center">training accuracy</th>
<th style="text-align:center">validation accuracy</th>
<th style="text-align:center">test accuracy</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">0.50</td>
<td style="text-align:center">0.50</td>
<td style="text-align:center">1.000</td>
<td style="text-align:center">0.966</td>
<td style="text-align:center">0.965</td>
</tr>
</tbody>
</table>
<p>Despite that training accuracy and validation are kind of far from each other, and it could be an overfitting sign, the test accuracy with respect the validation accuracy looks more consistent, and they are in a right level of accuracy.</p>
<h3 id="test-a-model-on-new-images">Test a Model on New Images</h3>
<h4 id="1-find-german-traffic-signs-found-on-the-web-and-provide-them-in-the-report">1. Find German traffic signs found on the web and provide them in the report.</h4>
<p>Here are twelve German traffic signs that I found on the web:</p>
<p><img src="/carnd/p2/test_images/0_speedlimit_20km_1.jpg" alt="alt text" title="Traffic Sign 1"> <img src="/carnd/p2/test_images/0_speedlimit_20km_2.jpg" alt="alt text" title="Traffic Sign 2"> <img src="/carnd/p2/test_images/1_speed_limit_30_1.jpg" alt="alt text" title="Traffic Sign 3">
<img src="/carnd/p2/test_images/2_speed_limit_50_1.jpg" alt="alt text" title="Traffic Sign 4"> <img src="/carnd/p2/test_images/2_speed_limit_50_2.jpg" alt="alt text" title="Traffic Sign 5"> <img src="/carnd/p2/test_images/7_speedlimit100.jpg" alt="alt text" title="Traffic Sign 6">
<img src="/carnd/p2/test_images/12_priority_road_1.jpg" alt="alt text" title="Traffic Sign 7"> <img src="/carnd/p2/test_images/13_yield_1.jpg" alt="alt text" title="Traffic Sign 8"> <img src="/carnd/p2/test_images/17_no_entry_1.jpg" alt="alt text" title="Traffic Sign 9">
<img src="/carnd/p2/test_images/25_road_work_1.jpg" alt="alt text" title="Traffic Sign 10"> <img src="/carnd/p2/test_images/31_wild_animals.jpg" alt="alt text" title="Traffic Sign 11"> <img src="/carnd/p2/test_images/36_Gostraightorright_1.jpg" alt="alt text" title="Traffic Sign 12"></p>
<p>The ten images (wild animals) might be difficult to classify because it is similar to the seven (road work) or maybe the image(road work) might be classified as (wild animals)</p>
<h4 id="2-discuss-the-models-predictions-on-new-traffic-signs">2. Discuss the model&rsquo;s predictions on new traffic signs.</h4>
<p>The code for making predictions on my final model is located in the tenth cell of the Ipython notebook.</p>
<p>Here are the results of the prediction:</p>
<table>
<thead>
<tr>
<th>Image</th>
<th style="text-align:center">Prediction</th>
</tr>
</thead>
<tbody>
<tr>
<td>Speed limit (20km/h)</td>
<td style="text-align:center">Speed limit (20km/h)</td>
</tr>
<tr>
<td>Speed limit (20km/h)</td>
<td style="text-align:center">Speed limit (20km/h)</td>
</tr>
<tr>
<td>Priority road</td>
<td style="text-align:center">Priority road</td>
</tr>
<tr>
<td>Yield</td>
<td style="text-align:center">Yield</td>
</tr>
<tr>
<td>No Entry</td>
<td style="text-align:center">No Entry</td>
</tr>
<tr>
<td>Speed limit (30km/h)</td>
<td style="text-align:center">Speed limit (30km/h)</td>
</tr>
<tr>
<td>Road work</td>
<td style="text-align:center">Road work</td>
</tr>
<tr>
<td>Speed limit (50km/h)</td>
<td style="text-align:center">Keep right</td>
</tr>
<tr>
<td>Speed limit (50km/h)</td>
<td style="text-align:center">Speed limit (80km/h)</td>
</tr>
<tr>
<td>Wild animals crossing</td>
<td style="text-align:center">Bicycles crossing</td>
</tr>
<tr>
<td>Go straight or right</td>
<td style="text-align:center">Go straight or right</td>
</tr>
<tr>
<td>Speed limit (100km/h)</td>
<td style="text-align:center">Speed limit (100km/h)</td>
</tr>
</tbody>
</table>
<p>The model was able to correctly guess 10 of the 12 traffic signs, which gives an accuracy of 83.33%. This compares maybe not favorably to the accuracy on the test set of 96.5%.</p>
<p>The new images are not to fit to avoid external noise provided by the behind landscape of the picture. For example, the prediction for 2_speed_limit_50_1 this image has in behind a lot of tree branches maybe that&rsquo;s why the model predicted wrong this example. It should be considered to either add more example with different backgrounds or pre-process more the new data to squeeze the background and just focus the signal itself.</p>
<h4 id="3-describe-model-certainty">3. Describe model certainty</h4>
<p>In general model it is good, there are some cases for the sign of (2-Speed limit (50km/h) -1 and (2-Speed limit (50km/h) -2 that models does not work as expected.</p>
<p>The code for making predictions on my final model is located in the twenty-second cell of the Ipython notebook.</p>
<p>Some scores for the top 5 softmax are too small to be represented by three decimals, for that reason, there will be scores of 0.100 in one class and 0.000 in others, which means that they have tiny probabilities. But it keeps the rank.</p>
<h4 id="for-the-1th-image">For the 1th image:</h4>
<p><img src="/carnd/p2/examples/pred_0_speedlimit_20km_1.png" alt="alt text" title="Prediction"></p>
<table>
<thead>
<tr>
<th>Probability</th>
<th style="text-align:center">Prediction</th>
</tr>
</thead>
<tbody>
<tr>
<td>0.100</td>
<td style="text-align:center">0-Speed limit (20km/h)</td>
</tr>
<tr>
<td>0.000</td>
<td style="text-align:center">1-Speed limit (30km/h)</td>
</tr>
<tr>
<td>0.000</td>
<td style="text-align:center">4-Speed limit (70km/h)</td>
</tr>
<tr>
<td>0.000</td>
<td style="text-align:center">16-Vehicles over 3.5 metric tons prohibited</td>
</tr>
<tr>
<td>0.000</td>
<td style="text-align:center">8-Speed limit (120km/h)</td>
</tr>
</tbody>
</table>
<h4 id="for-the-2th-image">For the 2th image:</h4>
<p><img src="/carnd/p2/examples/pred_0_speedlimit_20km_2.png" alt="alt text" title="Prediction"></p>
<table>
<thead>
<tr>
<th style="text-align:center">Probability</th>
<th style="text-align:center">Prediction</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">0.999</td>
<td style="text-align:center">0-Speed limit (20km/h)</td>
</tr>
<tr>
<td style="text-align:center">0.001</td>
<td style="text-align:center">16-Vehicles over 3.5 metric tons prohibited</td>
</tr>
<tr>
<td style="text-align:center">0.000</td>
<td style="text-align:center">3-Speed limit (60km/h)</td>
</tr>
<tr>
<td style="text-align:center">0.000</td>
<td style="text-align:center">8-Speed limit (120km/h)</td>
</tr>
<tr>
<td style="text-align:center">0.000</td>
<td style="text-align:center">1-Speed limit (30km/h)</td>
</tr>
</tbody>
</table>
<h4 id="for-the-3th-image">For the 3th image:</h4>
<p><img src="/carnd/p2/examples/pred_12_priority_road_1.png" alt="alt text" title="Prediction"></p>
<table>
<thead>
<tr>
<th style="text-align:center">Probability</th>
<th style="text-align:center">Prediction</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1.000</td>
<td style="text-align:center">12-Priority road</td>
</tr>
<tr>
<td style="text-align:center">0.000</td>
<td style="text-align:center">0-Speed limit (20km/h)</td>
</tr>
<tr>
<td style="text-align:center">0.000</td>
<td style="text-align:center">1-Speed limit (30km/h)</td>
</tr>
<tr>
<td style="text-align:center">0.000</td>
<td style="text-align:center">2-Speed limit (50km/h)</td>
</tr>
<tr>
<td style="text-align:center">0.000</td>
<td style="text-align:center">3-Speed limit (60km/h)</td>
</tr>
</tbody>
</table>
<h4 id="for-the-4th-image">For the 4th image:</h4>
<p><img src="/carnd/p2/examples/pred_13_yield_1.png" alt="alt text" title="Prediction"></p>
<table>
<thead>
<tr>
<th style="text-align:center">Probability</th>
<th style="text-align:center">Prediction</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1.000</td>
<td style="text-align:center">13-Yield</td>
</tr>
<tr>
<td style="text-align:center">0.000</td>
<td style="text-align:center">12-Priority road</td>
</tr>
<tr>
<td style="text-align:center">0.000</td>
<td style="text-align:center">38-Keep right</td>
</tr>
<tr>
<td style="text-align:center">0.000</td>
<td style="text-align:center">36-Go straight or right</td>
</tr>
<tr>
<td style="text-align:center">0.000</td>
<td style="text-align:center">9-No passing</td>
</tr>
</tbody>
</table>
<h4 id="for-the-5th-image">For the 5th image:</h4>
<p><img src="/carnd/p2/examples/pred_17_no_entry_1.png" alt="alt text" title="Prediction"></p>
<table>
<thead>
<tr>
<th style="text-align:center">Probability</th>
<th style="text-align:center">Prediction</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1.000</td>
<td style="text-align:center">17-No entry</td>
</tr>
<tr>
<td style="text-align:center">0.000</td>
<td style="text-align:center">14-Stop</td>
</tr>
<tr>
<td style="text-align:center">0.000</td>
<td style="text-align:center">0-Speed limit (20km/h)</td>
</tr>
<tr>
<td style="text-align:center">0.000</td>
<td style="text-align:center">1-Speed limit (30km/h)</td>
</tr>
<tr>
<td style="text-align:center">0.000</td>
<td style="text-align:center">2-Speed limit (50km/h)</td>
</tr>
</tbody>
</table>
<h4 id="for-the-6th-image">For the 6th image:</h4>
<p><img src="/carnd/p2/examples/pred_1_speed_limit_30_1.png" alt="alt text" title="Prediction"></p>
<table>
<thead>
<tr>
<th style="text-align:center">Probability</th>
<th style="text-align:center">Prediction</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1.000</td>
<td style="text-align:center">1-Speed limit (30km/h)</td>
</tr>
<tr>
<td style="text-align:center">0.000</td>
<td style="text-align:center">2-Speed limit (50km/h)</td>
</tr>
<tr>
<td style="text-align:center">0.000</td>
<td style="text-align:center">4-Speed limit (70km/h)</td>
</tr>
<tr>
<td style="text-align:center">0.000</td>
<td style="text-align:center">6-End of speed limit (80km/h)</td>
</tr>
<tr>
<td style="text-align:center">0.000</td>
<td style="text-align:center">5-Speed limit (80km/h)</td>
</tr>
</tbody>
</table>
<h4 id="for-the-7th-image">For the 7th image:</h4>
<p><img src="/carnd/p2/examples/pred_25_road_work_1.png" alt="alt text" title="Prediction"></p>
<table>
<thead>
<tr>
<th style="text-align:center">Probability</th>
<th style="text-align:center">Prediction</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1.000</td>
<td style="text-align:center">25-Road work</td>
</tr>
<tr>
<td style="text-align:center">0.000</td>
<td style="text-align:center">31-Wild animals crossing</td>
</tr>
<tr>
<td style="text-align:center">0.000</td>
<td style="text-align:center">22-Bumpy road</td>
</tr>
<tr>
<td style="text-align:center">0.000</td>
<td style="text-align:center">20-Dangerous curve to the right</td>
</tr>
<tr>
<td style="text-align:center">0.000</td>
<td style="text-align:center">12-Priority road</td>
</tr>
</tbody>
</table>
<h4 id="for-the-8th-image">For the 8th image:</h4>
<p><img src="/carnd/p2/examples/pred_2_speed_limit_50_1.png" alt="alt text" title="Prediction"></p>
<table>
<thead>
<tr>
<th style="text-align:center">Probability</th>
<th style="text-align:center">Prediction</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">0.605</td>
<td style="text-align:center">38-Keep right</td>
</tr>
<tr>
<td style="text-align:center">0.379</td>
<td style="text-align:center">13-Yield</td>
</tr>
<tr>
<td style="text-align:center">0.010</td>
<td style="text-align:center">36-Go straight or right</td>
</tr>
<tr>
<td style="text-align:center">0.003</td>
<td style="text-align:center">41-End of no passing</td>
</tr>
<tr>
<td style="text-align:center">0.001</td>
<td style="text-align:center">17-No entry</td>
</tr>
</tbody>
</table>
<h4 id="for-the-9th-image">For the 9th image:</h4>
<p><img src="/carnd/p2/examples/pred_2_speed_limit_50_2.png" alt="alt text" title="Prediction"></p>
<table>
<thead>
<tr>
<th style="text-align:center">Probability</th>
<th style="text-align:center">Prediction</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1.000</td>
<td style="text-align:center">5-Speed limit (80km/h)</td>
</tr>
<tr>
<td style="text-align:center">0.000</td>
<td style="text-align:center">7-Speed limit (100km/h)</td>
</tr>
<tr>
<td style="text-align:center">0.000</td>
<td style="text-align:center">2-Speed limit (50km/h)</td>
</tr>
<tr>
<td style="text-align:center">0.000</td>
<td style="text-align:center">3-Speed limit (60km/h)</td>
</tr>
<tr>
<td style="text-align:center">0.000</td>
<td style="text-align:center">6-End of speed limit (80km/h)</td>
</tr>
</tbody>
</table>
<h4 id="for-the-10th-image">For the 10th image:</h4>
<p><img src="/carnd/p2/examples/pred_31_wild_animals.png" alt="alt text" title="Prediction"></p>
<table>
<thead>
<tr>
<th style="text-align:center">Probability</th>
<th style="text-align:center">Prediction</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">0.897</td>
<td style="text-align:center">31-Wild animals crossing</td>
</tr>
<tr>
<td style="text-align:center">0.102</td>
<td style="text-align:center">23-Slippery road</td>
</tr>
<tr>
<td style="text-align:center">0.002</td>
<td style="text-align:center">21-Double curve</td>
</tr>
<tr>
<td style="text-align:center">0.000</td>
<td style="text-align:center">29-Bicycles crossing</td>
</tr>
<tr>
<td style="text-align:center">0.000</td>
<td style="text-align:center">19-Dangerous curve to the left</td>
</tr>
</tbody>
</table>
<h4 id="for-the-11th-image">For the 11th image:</h4>
<p><img src="/carnd/p2/examples/pred_36_Gostraightorright_1.png" alt="alt text" title="Prediction"></p>
<table>
<thead>
<tr>
<th style="text-align:center">Probability</th>
<th style="text-align:center">Prediction</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1.000</td>
<td style="text-align:center">36-Go straight or right</td>
</tr>
<tr>
<td style="text-align:center">0.000</td>
<td style="text-align:center">35-Ahead only</td>
</tr>
<tr>
<td style="text-align:center">0.000</td>
<td style="text-align:center">33-Turn right ahead</td>
</tr>
<tr>
<td style="text-align:center">0.000</td>
<td style="text-align:center">13-Yield</td>
</tr>
<tr>
<td style="text-align:center">0.000</td>
<td style="text-align:center">38-Keep right</td>
</tr>
</tbody>
</table>
<h4 id="for-the-12th-image">For the 12th image:</h4>
<p><img src="/carnd/p2/examples/pred_7_speedlimit100.png" alt="alt text" title="Prediction"></p>
<table>
<thead>
<tr>
<th style="text-align:center">Probability</th>
<th style="text-align:center">Prediction</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1.000</td>
<td style="text-align:center">7-Speed limit (100km/h)</td>
</tr>
<tr>
<td style="text-align:center">0.000</td>
<td style="text-align:center">10-No passing for vehicles over 3.5 metric tons</td>
</tr>
<tr>
<td style="text-align:center">0.000</td>
<td style="text-align:center">8-Speed limit (120km/h)</td>
</tr>
<tr>
<td style="text-align:center">0.000</td>
<td style="text-align:center">5-Speed limit (80km/h)</td>
</tr>
<tr>
<td style="text-align:center">0.000</td>
<td style="text-align:center">3-Speed limit (60km/h)</td>
</tr>
</tbody>
</table>

              


            </div>
          </div>
          <div id="post-footer" class="post-footer main-content-wrap">
            
              
            
            <div class="post-actions-wrap">
  <nav>
    <ul class="post-actions post-action-nav">
      
        <li class="post-action">
          
            <a class="post-action-btn btn btn--disabled">
          
            <i class="fa fa-angle-left"></i>
            <span class="hide-xs hide-sm text-small icon-ml">NEXT</span>
          </a>
        </li>
        <li class="post-action">
          
            <a class="post-action-btn btn btn--default tooltip--top" href="/2017/february/lane-lines-i/" data-tooltip="Lane Lines I">
          
            <span class="hide-xs hide-sm text-small icon-mr">PREVIOUS</span>
            <i class="fa fa-angle-right"></i>
          </a>
        </li>
      
    </ul>
  </nav>
  <ul class="post-actions post-action-share">
    
      <li class="post-action hide-lg hide-md hide-sm">
        <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions">
          <i class="fa fa-share-alt"></i>
        </a>
      </li>
      <li class="post-action hide-xs">
        <a class="post-action-btn btn btn--default" target="new" href="https://plus.google.com/share?url=https%3a%2f%2fmoisesvw.github.io%2f2017%2fmarch%2ftraffic-sign-recognition%2f">
          <i class="fa fa-google-plus"></i>
        </a>
      </li>
      <li class="post-action hide-xs">
        <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fmoisesvw.github.io%2f2017%2fmarch%2ftraffic-sign-recognition%2f">
          <i class="fa fa-facebook-official"></i>
        </a>
      </li>
      <li class="post-action hide-xs">
        <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=https%3a%2f%2fmoisesvw.github.io%2f2017%2fmarch%2ftraffic-sign-recognition%2f">
          <i class="fa fa-twitter"></i>
        </a>
      </li>
    
  </ul>
</div>


            
  


          </div>
        </article>
        <footer id="footer" class="main-content-wrap">
  <span class="copyrights">
    &copy; 2023 Moises Vargas. All Rights Reserved
  </span>
</footer>

      </div>
      <div id="bottom-bar" class="post-bottom-bar" data-behavior="2">
        <div class="post-actions-wrap">
  <nav>
    <ul class="post-actions post-action-nav">
      
        <li class="post-action">
          
            <a class="post-action-btn btn btn--disabled">
          
            <i class="fa fa-angle-left"></i>
            <span class="hide-xs hide-sm text-small icon-ml">NEXT</span>
          </a>
        </li>
        <li class="post-action">
          
            <a class="post-action-btn btn btn--default tooltip--top" href="/2017/february/lane-lines-i/" data-tooltip="Lane Lines I">
          
            <span class="hide-xs hide-sm text-small icon-mr">PREVIOUS</span>
            <i class="fa fa-angle-right"></i>
          </a>
        </li>
      
    </ul>
  </nav>
  <ul class="post-actions post-action-share">
    
      <li class="post-action hide-lg hide-md hide-sm">
        <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions">
          <i class="fa fa-share-alt"></i>
        </a>
      </li>
      <li class="post-action hide-xs">
        <a class="post-action-btn btn btn--default" target="new" href="https://plus.google.com/share?url=https%3a%2f%2fmoisesvw.github.io%2f2017%2fmarch%2ftraffic-sign-recognition%2f">
          <i class="fa fa-google-plus"></i>
        </a>
      </li>
      <li class="post-action hide-xs">
        <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fmoisesvw.github.io%2f2017%2fmarch%2ftraffic-sign-recognition%2f">
          <i class="fa fa-facebook-official"></i>
        </a>
      </li>
      <li class="post-action hide-xs">
        <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=https%3a%2f%2fmoisesvw.github.io%2f2017%2fmarch%2ftraffic-sign-recognition%2f">
          <i class="fa fa-twitter"></i>
        </a>
      </li>
    
  </ul>
</div>


      </div>
      

    </div>
    
    <div id="about">
  <div id="about-card">
    <div id="about-btn-close">
      <i class="fa fa-times"></i>
    </div>
    
    <h4 id="about-card-name">Moisés Vargas</h4>
    
      <div id="about-card-bio">Life Long Learner</div>
    
    
      <div id="about-card-job">
        <i class="fa fa-briefcase"></i>
        <br/>
        Machine Learning Engineer
      </div>
    
    
      <div id="about-card-location">
        <i class="fa fa-map-marker-alt"></i>
        <br/>
        Medellín
      </div>
    
  </div>
</div>

    

    
  
    
      
      <div id="cover" style="background-image:url('https://moisesvw.github.io/images/sfbridge_.jpg');"></div>
    
  


    
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" integrity="sha512-894YE6QWD5I59HgZOGReFYm4dnWc1Qt5NtvYSaNcOP+u1T9qYdvdihz0PPSiiqn/+/3e7Jo4EaG7TubfWGUrMQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha512-uURl+ZXMBrF4AwGaWmEetzrd+J5/8NRkWAvJx5sbPSSuOb0bZLqf+tOzniObO00BjHa/dD7gub9oCGMLPQHtQA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>


<script src="https://moisesvw.github.io/js/script-yqzy9wdlzix4lbbwdnzvwx3egsne77earqmn73v9uno8aupuph8wfguccut.min.js"></script>






    
  </body>
</html>

